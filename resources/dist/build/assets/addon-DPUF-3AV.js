const{resolveComponent:h,createElementBlock:i,openBlock:o,normalizeClass:c,createVNode:y,createCommentVNode:d,withCtx:v,createBlock:k,createElementVNode:p,normalizeStyle:w,toDisplayString:g}=window.Vue;var x=I;function I(e,t,u){var n=null,a=null,r=function(){n&&(clearTimeout(n),a=null,n=null)},f=function(){var l=a;r(),l&&l()},s=function(){if(!t)return e.apply(this,arguments);var l=this,m=arguments,b=u&&!n;if(r(),a=function(){e.apply(l,m)},n=setTimeout(function(){if(n=null,!b){var _=a;return a=null,_()}},t),b)return a()};return s.cancel=r,s.flush=f,s}const{Fieldtype:H,IndexFieldtype:N,FieldtypeMixin:E,IndexFieldtypeMixin:O,DateFormatter:A,ItemActions:q,requireElevatedSession:z,requireElevatedSessionIf:W}=__STATAMIC__.core,F=(e,t)=>{const u=e.__vccOpts||e;for(const[n,a]of t)u[n]=a;return u},R={mixins:[E],data(){return{embedInfo:{}}},computed:{prepend(){const{prepend:e="URL"}=this.config;return["null","false"].includes(e)?null:e},info(){return this.embedInfo[this.value]||{}},loadEmbedInfoDebounced(){return x(this.loadEmbedInfo,300)}},methods:{loadEmbedInfo(e){this.isUrl(e)&&this.$axios.post(this.meta.route,{url:e}).then(({data:t={}})=>{this.embedInfo[e]=t})},isUrl(e){if(!e)return!1;try{const{protocol:t}=new URL(e);return["http:","https:"].includes(t)}catch{return!1}},formatHostname(e){try{const{hostname:t}=new URL(e);return t.replace(/^www\d?\./,"")}catch(t){return console.error(t),e}}},created(){this.value&&this.meta.info&&(this.embedInfo[this.value]=this.meta.info)},watch:{value:{immediate:!0,handler(e){setTimeout(()=>{this.loadEmbedInfoDebounced(e)})}}}},U=["innerHTML"],T=["src"],C={key:2,class:"px-4 py-3 grid gap-0.5 text-sm"},L={class:"line-clamp-1 font-semibold text-gray-800 dark:text-gray-200"},S=["href"],V={key:0,class:"line-clamp-1 text-gray-500 dark:text-gray-400"},D={key:1,class:"text-gray-400 dark:text-gray-600"};function M(e,t,u,n,a,r){const f=h("ui-input-group-prepend"),s=h("ui-input"),l=h("ui-input-group");return o(),i("div",{class:c(["flex flex-col space-y-2",{"p-2 bg-gray-50 border border-gray-300 dark:bg-transparent dark:border-gray-700 rounded-xl":e.config.border}])},[y(l,null,{default:v(()=>[r.prepend?(o(),k(f,{key:0,text:e.__(r.prepend)},null,8,["text"])):d("",!0),y(s,{type:"url","model-value":e.value,isReadOnly:e.isReadOnly,placeholder:e.__(e.config.placeholder)||"https://","aria-label":e.__("Content URL"),"onUpdate:modelValue":e.update,onFocus:t[0]||(t[0]=m=>e.$emit("focus")),onBlur:t[1]||(t[1]=m=>e.$emit("blur")),"input-class":r.prepend?"border-s-0":""},null,8,["model-value","isReadOnly","placeholder","aria-label","onUpdate:modelValue","input-class"])]),_:1}),r.info.title||r.info.code||r.info.image?(o(),i("article",{key:0,class:c(["overflow-hidden border border-gray-300 dark:border-gray-700 rounded-lg",{"bg-white dark:bg-gray-900":e.config.border,"bg-gray-50 dark:bg-gray-900 shadow-ui-sm":!e.config.border}])},[r.info.code?(o(),i("div",{key:0,class:c({"p-2 pb-0":r.info.code.borderRadius})},[p("div",{innerHTML:r.info.code.html,class:c(["relative overflow-hidden [&_iframe]:w-full! [&_iframe]:max-w-none! [&_iframe]:h-full! [&_iframe]:border-0",{"aspect-(--embed-ratio)":r.info.code.ratio,"h-(--embed-height)":r.info.code.height&&!r.info.code.ratio}]),style:w({"--embed-ratio":r.info.code.ratio,"--embed-width":`${r.info.code.width??0}px`,"--embed-height":`${r.info.code.height??0}px`})},null,14,U)],2)):r.info.image?(o(),i("img",{key:1,src:r.info.image.url,class:"w-full h-auto"},null,8,T)):d("",!0),r.info.title?(o(),i("div",C,[p("p",L,[p("a",{href:r.info.url},g(r.info.title),9,S)]),r.info.description||r.info.author?.name?(o(),i("p",V,g(r.info.description||r.info.author?.name),1)):d("",!0),r.info.provider?.url?(o(),i("p",D,g(r.formatHostname(r.info.provider?.url)),1)):d("",!0)])):d("",!0)],2)):d("",!0)],2)}const B=F(R,[["render",M]]);Statamic.$components.register("embed-fieldtype",B);
