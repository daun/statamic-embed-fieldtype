const{resolveComponent:m,createElementBlock:a,openBlock:i,createVNode:h,createCommentVNode:s,withCtx:v,normalizeClass:g,createElementVNode:p,normalizeStyle:w,toDisplayString:_}=window.Vue;var x=k;function k(t,r,d){var n=null,o=null,e=function(){n&&(clearTimeout(n),o=null,n=null)},c=function(){var l=o;e(),l&&l()},u=function(){if(!r)return t.apply(this,arguments);var l=this,f=arguments,b=d&&!n;if(e(),o=function(){t.apply(l,f)},n=setTimeout(function(){if(n=null,!b){var y=o;return o=null,y()}},r),b)return o()};return u.cancel=e,u.flush=c,u}const{Fieldtype:O,IndexFieldtype:A,FieldtypeMixin:I,IndexFieldtypeMixin:B,DateFormatter:q,ItemActions:z,requireElevatedSession:W,requireElevatedSessionIf:j}=__STATAMIC__.core,E=(t,r)=>{const d=t.__vccOpts||t;for(const[n,o]of r)d[n]=o;return d},F={mixins:[I],data(){return{embedInfo:{}}},computed:{info(){return this.embedInfo[this.value]||{}},loadEmbedInfoDebounced(){return x(this.loadEmbedInfo,300)}},methods:{loadEmbedInfo(t){this.isUrl(t)&&this.$axios.post(this.meta.route,{url:t}).then(({data:r={}})=>{this.embedInfo[t]=r})},isUrl(t){if(!t)return!1;try{const{protocol:r}=new URL(t);return["http:","https:"].includes(r)}catch{return!1}},formatHostname(t){try{const{hostname:r}=new URL(t);return r.replace(/^www\d?\./,"")}catch(r){return console.error(r),t}}},created(){this.value&&this.meta.info&&(this.embedInfo[this.value]=this.meta.info)},watch:{value:{immediate:!0,handler(t){setTimeout(()=>{this.loadEmbedInfoDebounced(t)})}}}},R={class:"flex flex-col space-y-2 p-2 bg-gray-50 border border-gray-300 dark:bg-transparent dark:border-gray-700 rounded-xl"},U={key:0,class:"overflow-hidden bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg"},T=["innerHTML"],C=["src"],L={key:2,class:"px-4 py-3 grid gap-0.5 text-sm"},S={class:"line-clamp-1 font-semibold text-gray-800 dark:text-gray-200"},V=["href"],D={key:0,class:"line-clamp-1 text-gray-500 dark:text-gray-400"},M={key:1,class:"text-gray-400 dark:text-gray-600"};function H(t,r,d,n,o,e){const c=m("ui-input-group-prepend"),u=m("ui-input"),l=m("ui-input-group");return i(),a("div",R,[h(l,null,{default:v(()=>[h(c,{text:t.__("URL")},null,8,["text"]),h(u,{"model-value":t.value,isReadOnly:t.isReadOnly,placeholder:t.__(t.config.placeholder)||"https://","aria-label":t.__("Content URL"),"onUpdate:modelValue":t.update,onFocus:r[0]||(r[0]=f=>t.$emit("focus")),onBlur:r[1]||(r[1]=f=>t.$emit("blur")),"input-class":"border-s-0"},null,8,["model-value","isReadOnly","placeholder","aria-label","onUpdate:modelValue"])]),_:1}),e.info.title||e.info.code||e.info.image?(i(),a("article",U,[e.info.code?(i(),a("div",{key:0,class:g({"p-2 pb-0":e.info.code.borderRadius})},[p("div",{innerHTML:e.info.code.html,class:g(["relative overflow-hidden [&_iframe]:w-full! [&_iframe]:max-w-none! [&_iframe]:h-full! [&_iframe]:border-0",{"aspect-(--embed-ratio)":e.info.code.ratio,"h-(--embed-height)":e.info.code.height&&!e.info.code.ratio}]),style:w({"--embed-ratio":e.info.code.ratio,"--embed-width":`${e.info.code.width??0}px`,"--embed-height":`${e.info.code.height??0}px`})},null,14,T)],2)):e.info.image?(i(),a("img",{key:1,src:e.info.image.url,class:"w-full h-auto"},null,8,C)):s("",!0),e.info.title?(i(),a("div",L,[p("p",S,[p("a",{href:e.info.url},_(e.info.title),9,V)]),e.info.description||e.info.author?.name?(i(),a("p",D,_(e.info.description||e.info.author?.name),1)):s("",!0),e.info.provider?.url?(i(),a("p",M,_(e.formatHostname(e.info.provider?.url)),1)):s("",!0)])):s("",!0)])):s("",!0)])}const N=E(F,[["render",H]]);Statamic.$components.register("embed-fieldtype",N);
