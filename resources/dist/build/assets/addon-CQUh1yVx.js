const{resolveComponent:m,createElementBlock:a,openBlock:o,normalizeClass:c,createVNode:y,createCommentVNode:d,withCtx:_,createBlock:w,createElementVNode:p,normalizeStyle:x,toDisplayString:g}=window.Vue;var k=I;function I(r,t,u){var n=null,i=null,e=function(){n&&(clearTimeout(n),i=null,n=null)},f=function(){var l=i;e(),l&&l()},s=function(){if(!t)return r.apply(this,arguments);var l=this,h=arguments,b=u&&!n;if(e(),i=function(){r.apply(l,h)},n=setTimeout(function(){if(n=null,!b){var v=i;return i=null,v()}},t),b)return i()};return s.cancel=e,s.flush=f,s}const{Fieldtype:H,IndexFieldtype:N,FieldtypeMixin:E,IndexFieldtypeMixin:O,DateFormatter:P,ItemActions:A,requireElevatedSession:q,requireElevatedSessionIf:z}=__STATAMIC__.core,S=(r,t)=>{const u=r.__vccOpts||r;for(const[n,i]of t)u[n]=i;return u},T={mixins:[E],data(){return{embedInfo:{}}},computed:{prepend(){const{prepend:r="URL"}=this.config;return["null","false"].includes(r)?null:r},shouldShowPreview(){return this.config.preview_type!=="none"},shouldShowEmbed(){return["embed"].includes(this.config.preview_type)},shouldShowImage(){return["embed","thumbnail"].includes(this.config.preview_type)},shouldEnforceImage(){return["thumbnail"].includes(this.config.preview_type)},shouldShowText(){return["embed","thumbnail","text"].includes(this.config.preview_type)},hasPreviewData(){return this.info.title||this.info.code||this.info.image},info(){return this.embedInfo[this.value]||{}},loadEmbedInfoDebounced(){return k(this.loadEmbedInfo,300)}},methods:{loadEmbedInfo(r){this.isUrl(r)&&this.$axios.post(this.meta.route,{url:r}).then(({data:t={}})=>{this.embedInfo[r]=t})},isUrl(r){if(!r)return!1;try{const{protocol:t}=new URL(r);return["http:","https:"].includes(t)}catch{return!1}},formatHostname(r){try{const{hostname:t}=new URL(r);return t.replace(/^www\d?\./,"")}catch(t){return console.error(t),r}}},created(){this.value&&this.meta.info&&(this.embedInfo[this.value]=this.meta.info)},watch:{value:{immediate:!0,handler(r){setTimeout(()=>{this.loadEmbedInfoDebounced(r)})}}}},F=["innerHTML"],R=["src"],U={key:2,class:"px-4 py-3 grid gap-0.5 text-sm self-start"},D={class:"line-clamp-1 font-semibold text-gray-800 dark:text-gray-200"},C=["href"],L={key:0,class:"line-clamp-1 text-gray-500 dark:text-gray-400"},V={key:1,class:"text-gray-400 dark:text-gray-600"};function M(r,t,u,n,i,e){const f=m("ui-input-group-prepend"),s=m("ui-input"),l=m("ui-input-group");return o(),a("div",{class:c(["flex flex-col gap-2",{"p-2 bg-gray-50 border border-gray-300 dark:bg-transparent dark:border-gray-700 rounded-xl":r.config.border}])},[y(l,null,{default:_(()=>[e.prepend?(o(),w(f,{key:0,text:r.__(e.prepend)},null,8,["text"])):d("",!0),y(s,{type:"url","model-value":r.value,isReadOnly:r.isReadOnly,placeholder:r.__(r.config.placeholder)||"https://","aria-label":r.__("Content URL"),"onUpdate:modelValue":r.update,onFocus:t[0]||(t[0]=h=>r.$emit("focus")),onBlur:t[1]||(t[1]=h=>r.$emit("blur")),"input-class":e.prepend?"border-s-0":""},null,8,["model-value","isReadOnly","placeholder","aria-label","onUpdate:modelValue","input-class"])]),_:1}),e.shouldShowPreview&&e.hasPreviewData?(o(),a("article",{key:0,class:c(["overflow-hidden border border-gray-300 dark:border-gray-700 rounded-lg",{"bg-white dark:bg-gray-900":r.config.border,"bg-gray-50 dark:bg-gray-900 shadow-ui-sm":!r.config.border,flex:e.shouldEnforceImage&&e.info.image}])},[e.shouldShowEmbed&&e.info.code?(o(),a("div",{key:0,class:c({"p-2 pb-0":e.info.code.borderRadius})},[p("div",{innerHTML:e.info.code.html,class:c(["relative overflow-hidden [&_iframe]:w-full! [&_iframe]:max-w-none! [&_iframe]:h-full! [&_iframe]:border-0",{"aspect-(--embed-ratio)":e.info.code.ratio,"h-(--embed-height)":e.info.code.height&&!e.info.code.ratio}]),style:x({"--embed-ratio":e.info.code.ratio,"--embed-width":`${e.info.code.width??0}px`,"--embed-height":`${e.info.code.height??0}px`})},null,14,F)],2)):e.shouldShowImage&&e.info.image?(o(),a("img",{key:1,src:e.info.image.url,class:c({"w-full h-auto":!e.shouldEnforceImage,"flex-0 h-24 w-auto max-w-1/3! self-stretch object-cover":e.shouldEnforceImage})},null,10,R)):d("",!0),e.shouldShowText&&e.info.title?(o(),a("div",U,[p("p",D,[p("a",{href:e.info.url},g(e.info.title),9,C)]),e.info.description||e.info.author?.name?(o(),a("p",L,g(e.info.description||e.info.author?.name),1)):d("",!0),e.info.provider?.url?(o(),a("p",V,g(e.formatHostname(e.info.provider?.url)),1)):d("",!0)])):d("",!0)],2)):d("",!0)],2)}const B=S(T,[["render",M]]);Statamic.$components.register("embed-fieldtype",B);
