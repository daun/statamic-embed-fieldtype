var b=S;function S(t,r,d){var o=null,n=null,e=function(){o&&(clearTimeout(o),n=null,o=null)},f=function(){var s=n;e(),s&&s()},c=function(){if(!r)return t.apply(this,arguments);var s=this,m=arguments,v=d&&!o;if(e(),n=function(){t.apply(s,m)},o=setTimeout(function(){if(o=null,!v){var w=n;return n=null,w()}},r),v)return n()};return c.cancel=e,c.flush=f,c}const{Fieldtype:U,IndexFieldtype:B,FieldtypeMixin:R,HasActionsMixin:N,HasInputOptionsMixin:L,HasPreferencesMixin:z,IndexFieldtypeMixin:W,InlineEditForm:K,DateFormatter:j,ItemActions:q,RelatedItem:G,RestoreRevision:Q,RevisionHistory:J,RevisionPreview:X,SaveButtonOptions:Y,SortableList:Z,requireElevatedSession:$,requireElevatedSessionIf:ee,clone:te,deepClone:re,resetValuesFromResponse:oe}=__STATAMIC__.core,_=window.Vue,{BaseTransition:ne,BaseTransitionPropsValidators:ie,Comment:ae,DeprecationTypes:se,EffectScope:le,ErrorCodes:de,ErrorTypeStrings:ce,Fragment:ue,KeepAlive:fe,ReactiveEffect:me,Static:he,Suspense:pe,Teleport:ge,Text:ve,TrackOpTypes:ye,Transition:we,TransitionGroup:be,TriggerOpTypes:Se,VueElement:Re,__esModule:_e,assertNumber:xe,callWithAsyncErrorHandling:Ee,callWithErrorHandling:Te,camelize:Ce,capitalize:Ie,cloneVNode:ke,compatUtils:Me,compile:De,computed:Pe,createApp:Ve,createBlock:x,createCommentVNode:l,createElementBlock:a,createElementVNode:h,createHydrationRenderer:He,createPropsRestProxy:Fe,createRenderer:Oe,createSSRApp:Ae,createSlots:Ue,createStaticVNode:Be,createTextVNode:Ne,createVNode:y,customRef:Le,defineAsyncComponent:ze,defineComponent:We,defineCustomElement:Ke,defineEmits:je,defineExpose:qe,defineModel:Ge,defineOptions:Qe,defineProps:Je,defineSSRCustomElement:Xe,defineSlots:Ye,devtools:Ze,effect:$e,effectScope:et,getCurrentInstance:tt,getCurrentScope:rt,getCurrentWatcher:ot,getTransitionRawChildren:nt,guardReactiveProps:it,h:at,handleError:st,hasInjectionContext:lt,hydrate:dt,hydrateOnIdle:ct,hydrateOnInteraction:ut,hydrateOnMediaQuery:ft,hydrateOnVisible:mt,initCustomFormatter:ht,initDirectivesForSSR:pt,inject:gt,isMemoSame:vt,isProxy:yt,isReactive:wt,isReadonly:bt,isRef:St,isRuntimeOnly:Rt,isShallow:_t,isVNode:xt,markRaw:Et,mergeDefaults:Tt,mergeModels:Ct,mergeProps:It,nextTick:kt,nodeOps:Mt,normalizeClass:u,normalizeProps:Dt,normalizeStyle:E,onActivated:Pt,onBeforeMount:Vt,onBeforeUnmount:Ht,onBeforeUpdate:Ft,onDeactivated:Ot,onErrorCaptured:At,onMounted:Ut,onRenderTracked:Bt,onRenderTriggered:Nt,onScopeDispose:Lt,onServerPrefetch:zt,onUnmounted:Wt,onUpdated:Kt,onWatcherCleanup:jt,openBlock:i,patchProp:qt,popScopeId:Gt,provide:Qt,proxyRefs:Jt,pushScopeId:Xt,queuePostFlushCb:Yt,reactive:Zt,readonly:$t,ref:er,registerRuntimeCompiler:tr,render:rr,renderList:or,renderSlot:nr,resolveComponent:p,resolveDirective:ir,resolveDynamicComponent:ar,resolveFilter:sr,resolveTransitionHooks:lr,setBlockTracking:dr,setDevtoolsHook:cr,setTransitionHooks:ur,shallowReactive:fr,shallowReadonly:mr,shallowRef:hr,ssrContextKey:pr,ssrUtils:gr,stop:vr,toDisplayString:g,toHandlerKey:yr,toHandlers:wr,toRaw:br,toRef:Sr,toRefs:Rr,toValue:_r,transformVNodeArgs:xr,triggerRef:Er,unref:Tr,useAttrs:Cr,useCssModule:Ir,useCssVars:kr,useHost:Mr,useId:Dr,useModel:Pr,useSSRContext:Vr,useShadowRoot:Hr,useSlots:Fr,useTemplateRef:Or,useTransitionState:Ar,vModelCheckbox:Ur,vModelDynamic:Br,vModelRadio:Nr,vModelSelect:Lr,vModelText:zr,vShow:Wr,version:Kr,warn:jr,watch:qr,watchEffect:Gr,watchPostEffect:Qr,watchSyncEffect:Jr,withAsyncContext:Xr,withCtx:T,withDefaults:Yr,withDirectives:Zr,withKeys:$r,withMemo:eo,withModifiers:to,withScopeId:ro}=_,C=(t,r)=>{const d=t.__vccOpts||t;for(const[o,n]of r)d[o]=n;return d},I={mixins:[R],data(){return{embedInfo:{}}},computed:{shouldShowPreview(){return this.config.preview_type!=="none"},shouldShowEmbed(){return["embed"].includes(this.config.preview_type)},shouldShowImage(){return["embed","thumbnail"].includes(this.config.preview_type)},shouldEnforceImage(){return["thumbnail"].includes(this.config.preview_type)},shouldShowText(){return["embed","thumbnail","text"].includes(this.config.preview_type)},hasPreviewData(){return this.info.title||this.info.code||this.info.image},info(){return this.embedInfo[this.value]||{}},loadEmbedInfoDebounced(){return b(this.loadEmbedInfo,300)}},methods:{loadEmbedInfo(t){this.isUrl(t)&&this.$axios.post(this.meta.route,{url:t}).then(({data:r={}})=>{this.embedInfo[t]=r})},isUrl(t){if(!t)return!1;try{const{protocol:r}=new URL(t);return["http:","https:"].includes(r)}catch{return!1}},formatHostname(t){try{const{hostname:r}=new URL(t);return r.replace(/^www\d?\./,"")}catch(r){return console.error(r),t}}},created(){this.value&&this.meta.info&&(this.embedInfo[this.value]=this.meta.info)},watch:{value:{immediate:!0,handler(t){setTimeout(()=>{this.loadEmbedInfoDebounced(t)})}}}},k=["innerHTML"],M=["src"],D={key:2,class:"px-4 py-3 grid gap-0.5 text-sm self-start"},P={class:"line-clamp-1 font-semibold text-gray-800 dark:text-gray-200"},V=["href"],H={key:0,class:"line-clamp-1 text-gray-500 dark:text-gray-400"},F={key:1,class:"text-gray-400 dark:text-gray-600"};function O(t,r,d,o,n,e){const f=p("ui-input-group-prepend"),c=p("ui-input"),s=p("ui-input-group");return i(),a("div",{class:u(["flex flex-col gap-2",{"p-2 bg-gray-50 border border-gray-300 dark:bg-transparent dark:border-gray-700 rounded-xl":t.config.border}])},[y(s,null,{default:T(()=>[t.config.prepend?(i(),x(f,{key:0,text:t.__(t.config.prepend)},null,8,["text"])):l("",!0),y(c,{type:"url","model-value":t.value,isReadOnly:t.isReadOnly,placeholder:t.__(t.config.placeholder)||"https://","aria-label":t.__("Content URL"),"onUpdate:modelValue":t.update,onFocus:r[0]||(r[0]=m=>t.$emit("focus")),onBlur:r[1]||(r[1]=m=>t.$emit("blur")),"input-class":t.config.prepend?"border-s-0":""},null,8,["model-value","isReadOnly","placeholder","aria-label","onUpdate:modelValue","input-class"])]),_:1}),e.shouldShowPreview&&e.hasPreviewData?(i(),a("article",{key:0,class:u(["overflow-hidden border border-gray-300 dark:border-gray-700 rounded-lg",{"bg-white dark:bg-gray-900":t.config.border,"bg-gray-50 dark:bg-gray-900 shadow-ui-sm":!t.config.border,flex:e.shouldEnforceImage&&e.info.image}])},[e.shouldShowEmbed&&e.info.code?(i(),a("div",{key:0,class:u({"p-2 pb-0":e.info.code.borderRadius})},[h("div",{innerHTML:e.info.code.html,class:u(["relative overflow-hidden [&_iframe]:w-full! [&_iframe]:max-w-none! [&_iframe]:h-full! [&_iframe]:border-0",{"aspect-(--embed-ratio)":e.info.code.ratio,"h-(--embed-height)":e.info.code.height&&!e.info.code.ratio}]),style:E({"--embed-ratio":e.info.code.ratio,"--embed-width":`${e.info.code.width??0}px`,"--embed-height":`${e.info.code.height??0}px`})},null,14,k)],2)):e.shouldShowImage&&e.info.image?(i(),a("img",{key:1,src:e.info.image.url,class:u({"w-full h-auto":!e.shouldEnforceImage,"flex-0 h-24 w-auto max-w-1/3! self-stretch object-cover":e.shouldEnforceImage})},null,10,M)):l("",!0),e.shouldShowText&&e.info.title?(i(),a("div",D,[h("p",P,[h("a",{href:e.info.url},g(e.info.title),9,V)]),e.info.description||e.info.author?.name?(i(),a("p",H,g(e.info.description||e.info.author?.name),1)):l("",!0),e.info.provider?.url?(i(),a("p",F,g(e.formatHostname(e.info.provider?.url)),1)):l("",!0)])):l("",!0)],2)):l("",!0)],2)}const A=C(I,[["render",O]]);Statamic.$components.register("embed-fieldtype",A);
