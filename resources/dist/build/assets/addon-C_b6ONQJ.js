const{resolveComponent:m,createElementBlock:i,openBlock:o,createVNode:b,createCommentVNode:d,withCtx:v,createBlock:k,normalizeClass:g,createElementVNode:h,normalizeStyle:w,toDisplayString:p}=window.Vue;var x=I;function I(t,r,u){var n=null,a=null,e=function(){n&&(clearTimeout(n),a=null,n=null)},c=function(){var l=a;e(),l&&l()},s=function(){if(!r)return t.apply(this,arguments);var l=this,f=arguments,_=u&&!n;if(e(),a=function(){t.apply(l,f)},n=setTimeout(function(){if(n=null,!_){var y=a;return a=null,y()}},r),_)return a()};return s.cancel=e,s.flush=c,s}const{Fieldtype:O,IndexFieldtype:A,FieldtypeMixin:E,IndexFieldtypeMixin:q,DateFormatter:z,ItemActions:W,requireElevatedSession:j,requireElevatedSessionIf:G}=__STATAMIC__.core,F=(t,r)=>{const u=t.__vccOpts||t;for(const[n,a]of r)u[n]=a;return u},R={mixins:[E],data(){return{embedInfo:{}}},computed:{prepend(){const{prepend:t="URL"}=this.config;return["null","false"].includes(t)?null:t},info(){return this.embedInfo[this.value]||{}},loadEmbedInfoDebounced(){return x(this.loadEmbedInfo,300)}},methods:{loadEmbedInfo(t){this.isUrl(t)&&this.$axios.post(this.meta.route,{url:t}).then(({data:r={}})=>{this.embedInfo[t]=r})},isUrl(t){if(!t)return!1;try{const{protocol:r}=new URL(t);return["http:","https:"].includes(r)}catch{return!1}},formatHostname(t){try{const{hostname:r}=new URL(t);return r.replace(/^www\d?\./,"")}catch(r){return console.error(r),t}}},created(){this.value&&this.meta.info&&(this.embedInfo[this.value]=this.meta.info)},watch:{value:{immediate:!0,handler(t){setTimeout(()=>{this.loadEmbedInfoDebounced(t)})}}}},U={class:"flex flex-col space-y-2 p-2 bg-gray-50 border border-gray-300 dark:bg-transparent dark:border-gray-700 rounded-xl"},T={key:0,class:"overflow-hidden bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-lg"},C=["innerHTML"],L=["src"],S={key:2,class:"px-4 py-3 grid gap-0.5 text-sm"},V={class:"line-clamp-1 font-semibold text-gray-800 dark:text-gray-200"},D=["href"],M={key:0,class:"line-clamp-1 text-gray-500 dark:text-gray-400"},B={key:1,class:"text-gray-400 dark:text-gray-600"};function H(t,r,u,n,a,e){const c=m("ui-input-group-prepend"),s=m("ui-input"),l=m("ui-input-group");return o(),i("div",U,[b(l,null,{default:v(()=>[e.prepend?(o(),k(c,{key:0,text:t.__(e.prepend)},null,8,["text"])):d("",!0),b(s,{"model-value":t.value,isReadOnly:t.isReadOnly,placeholder:t.__(t.config.placeholder)||"https://","aria-label":t.__("Content URL"),"onUpdate:modelValue":t.update,onFocus:r[0]||(r[0]=f=>t.$emit("focus")),onBlur:r[1]||(r[1]=f=>t.$emit("blur")),"input-class":e.prepend?"border-s-0":""},null,8,["model-value","isReadOnly","placeholder","aria-label","onUpdate:modelValue","input-class"])]),_:1}),e.info.title||e.info.code||e.info.image?(o(),i("article",T,[e.info.code?(o(),i("div",{key:0,class:g({"p-2 pb-0":e.info.code.borderRadius})},[h("div",{innerHTML:e.info.code.html,class:g(["relative overflow-hidden [&_iframe]:w-full! [&_iframe]:max-w-none! [&_iframe]:h-full! [&_iframe]:border-0",{"aspect-(--embed-ratio)":e.info.code.ratio,"h-(--embed-height)":e.info.code.height&&!e.info.code.ratio}]),style:w({"--embed-ratio":e.info.code.ratio,"--embed-width":`${e.info.code.width??0}px`,"--embed-height":`${e.info.code.height??0}px`})},null,14,C)],2)):e.info.image?(o(),i("img",{key:1,src:e.info.image.url,class:"w-full h-auto"},null,8,L)):d("",!0),e.info.title?(o(),i("div",S,[h("p",V,[h("a",{href:e.info.url},p(e.info.title),9,D)]),e.info.description||e.info.author?.name?(o(),i("p",M,p(e.info.description||e.info.author?.name),1)):d("",!0),e.info.provider?.url?(o(),i("p",B,p(e.formatHostname(e.info.provider?.url)),1)):d("",!0)])):d("",!0)])):d("",!0)])}const N=F(R,[["render",H]]);Statamic.$components.register("embed-fieldtype",N);
